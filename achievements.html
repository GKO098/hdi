<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®Ÿç¸¾</title>
    <link rel="icon" type="image/png" href="icons/favicon.png">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="header.css">
    <link rel="stylesheet" href="achievements.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/papaparse@5.4.1/papaparse.min.js"></script>
</head>
<body>
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’èª­ã¿è¾¼ã¿ -->
    <div id="header-placeholder"></div>

    <div class="container">
        <h1>å®Ÿç¸¾</h1>
        <div style="margin-bottom: 20px;">
            <button onclick="showAllLocations()" style="margin-left: 20px;" class="map-button">ğŸ—ºï¸ å…¨ã¦ã®å ´æ‰€ã‚’åœ°å›³ã§è¦‹ã‚‹</button>
        </div>
        <div class="description" style="margin-bottom: 20px;">
            <small>â€»æ²³å·ã‚„åºƒåŸŸãªå ´æ‰€ã®åº§æ¨™ã¯ã€ä»£è¡¨çš„ãªåœ°ç‚¹ã‚’é¸ã‚“ã§ã„ã¾ã™ã€‚</small>
            <small>â€»æ—¥ä»˜ã‚’æ€ã„å‡ºã›ãªã„å ´æ‰€ã¯xxxx-xx-xxã¨ã—ã¦ã„ã¾ã™ã€‚</small>
            <small>â€»å¤œæ™¯ã‚¹ãƒãƒƒãƒˆãªã®ã«æ˜¼ã«è¡Œã£ãŸãªã©ã€æ¥½ã—ã¿æ–¹ãŒé•ã†è¨ªå•æ—¥ã¯æ‹¬å¼§æ›¸ãã«ã—ã¦ã„ã¾ã™ã€‚</small>
            <small>ã€Œ<a href="https://100sen.cyber-ninja.jp/" target="_blank" rel="noopener noreferrer">æ—¥æœ¬ç™¾é¸ã¨åº§æ¨™å€¤ï¼ˆçµŒç·¯åº¦æ•°å€¤ï¼‰</a>ã€ãªã©ã‚’å‚è€ƒã«ã—ã¦ã„ã¾ã™ã€‚</small>
        </div>
        <div id="achievements-container">
            <!-- JavaScriptã§å‹•çš„ã«ç”Ÿæˆ -->
        </div>
    </div>

    <!-- åœ°å›³è¡¨ç¤ºç”¨ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="mapModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeMap()">&times;</span>
            <h2 id="mapTitle"></h2>
            <div id="map"></div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’èª­ã¿è¾¼ã‚€
        fetch('header.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('header-placeholder').innerHTML = data;
                
                // ãƒ˜ãƒƒãƒ€ãƒ¼èª­ã¿è¾¼ã¿å¾Œã«ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒªãƒ³ã‚¯ã‚’è¨­å®š
                const currentPath = window.location.pathname;
                const currentPage = currentPath.split('/').pop() || 'index.html';
                const navLinks = document.querySelectorAll('.nav-link');
                
                navLinks.forEach(link => {
                    const href = link.getAttribute('href');
                    if (href === currentPage) {
                        link.classList.add('active');
                    }
                });
            });

        let map = null;
        let achievementsData = {};

        // å…¨ã¦ã®å ´æ‰€ã‚’åœ°å›³ã«è¡¨ç¤ºã™ã‚‹é–¢æ•°
        function showAllLocations() {
            const modal = document.getElementById('mapModal');
            const mapTitle = document.getElementById('mapTitle');
            
            mapTitle.textContent = 'å…¨ã¦ã®å®Ÿç¸¾ã®å ´æ‰€';
            modal.style.display = 'block';

            if (map) {
                map.remove();
            }

            map = L.map('map');
            L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
                attribution: 'Â© OpenStreetMap & CartoDB',
                subdomains: 'abcd'
            }).addTo(map);

            // ä½ç½®æƒ…å ±ãƒœã‚¿ãƒ³ã‚’è¿½åŠ 
            const locationButton = L.control({ position: 'bottomright' });
            locationButton.onAdd = () => {
                const div = L.DomUtil.create('div', 'leaflet-bar leaflet-control');
                div.innerHTML = `
                    <a href="#" title="ç¾åœ¨åœ°ã‚’è¡¨ç¤º" style="display: flex; align-items: center; justify-content: center; width: 30px; height: 30px; background: white; border-radius: 4px;">
                        <svg viewBox="0 0 24 24" style="width: 18px; height: 18px;">
                            <path d="M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3A8.994 8.994 0 0 0 13 3.06V1h-2v2.06A8.994 8.994 0 0 0 3.06 11H1v2h2.06A8.994 8.994 0 0 0 11 20.94V23h2v-2.06A8.994 8.994 0 0 0 20.94 13H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z" fill="currentColor"/>
                        </svg>
                    </a>
                `;
                div.onclick = (e) => {
                    e.preventDefault();
                    showCurrentLocation(map);
                };
                return div;
            };
            locationButton.addTo(map);

            // ãƒãƒ¼ã‚«ãƒ¼ã‚¢ã‚¤ã‚³ãƒ³ã‚’å®šç¾©
            const visitedIcon = L.divIcon({
                className: 'custom-marker',
                html: `<div class="marker-circle" style="background-color: green;">âœ“</div>`,
                iconSize: [12, 12],
                iconAnchor: [6, 6]
            });

            const partialIcon = L.divIcon({
                className: 'custom-marker',
                html: `<div class="marker-circle" style="background-color: #ffa000;">â–³</div>`,
                iconSize: [12, 12],
                iconAnchor: [6, 6]
            });

            const unvisitedIcon = L.divIcon({
                className: 'custom-marker',
                html: `<div class="marker-circle" style="background-color: red;">Ã—</div>`,
                iconSize: [12, 12],
                iconAnchor: [6, 6]
            });

            const coordinates = [];
            
            // å…¨ã¦ã®ã‚«ãƒ†ã‚´ãƒªãƒ¼ã®ã‚¹ãƒãƒƒãƒˆã‚’å‡¦ç†
            Object.entries(achievementsData).forEach(([category, data]) => {
                data.spots.forEach(spot => {
                    if (spot.coordinates) {
                        coordinates.push(spot.coordinates);
                        const hasConfirmedVisits = spot.confirmedDates && spot.confirmedDates.length > 0;
                        const hasPartialVisits = spot.partialDates && spot.partialDates.length > 0;
                        
                        let visitInfo;
                        let icon;
                        if (hasConfirmedVisits) {
                            visitInfo = `è¨ªå•æ¸ˆã¿<br>${spot.confirmedDates.map(date => `ãƒ»${date}`).join('<br>')}`;
                            if (hasPartialVisits) {
                                visitInfo += `<br>å‚è€ƒè¨˜éŒ²<br>${spot.partialDates.map(date => `ãƒ»${date}`).join('<br>')}`;
                            }
                            icon = visitedIcon;
                        } else if (hasPartialVisits) {
                            visitInfo = `å‚è€ƒè¨˜éŒ²<br>${spot.partialDates.map(date => `ãƒ»${date}`).join('<br>')}`;
                            icon = partialIcon;
                        } else {
                            visitInfo = 'æœªè¨ªå•';
                            icon = unvisitedIcon;
                        }

                        L.marker(spot.coordinates, { icon })
                        .bindPopup(`
                            <strong>${spot.name}</strong><br>
                            <small>${category}</small><br>
                            ${visitInfo}
                        `)
                        .addTo(map);
                    }
                });
            });

            if (coordinates.length > 0) {
                const bounds = L.latLngBounds(coordinates);
                map.fitBounds(bounds, { padding: [50, 50] });
            }
        }

        // CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã§ãƒ‘ãƒ¼ã‚¹ã™ã‚‹é–¢æ•°
        async function loadAchievementsData() {
            try {
                const response = await fetch('./data/achievements.csv');
                const csvText = await response.text();
                
                // PapaParseã‚’ä½¿ç”¨ã—ã¦CSVã‚’ãƒ‘ãƒ¼ã‚¹
                const parseResult = Papa.parse(csvText, {
                    header: true,
                    skipEmptyLines: true
                });

                // ã‚«ãƒ†ã‚´ãƒªãƒ¼ã”ã¨ã«ãƒ‡ãƒ¼ã‚¿ã‚’æ•´ç†
                achievementsData = parseResult.data.reduce((acc, row) => {
                    const category = row.category;
                    const name = row.name;
                    const noInCategory = row.no_in_category;
                    const latitude = parseFloat(row.latitude);
                    const longitude = parseFloat(row.longitude);
                    const visitedDates = row.visited_dates ? row.visited_dates.split(',').map(date => date.trim()).filter(date => date) : [];
                    
                    // æ—¥ä»˜ã‚’ç¢ºå®šè¨ªå•ã¨éƒ¨åˆ†è¨ªå•ã«åˆ†é¡
                    const confirmedDates = visitedDates.filter(date => !date.startsWith('(') && !date.endsWith(')'));
                    const partialDates = visitedDates.filter(date => date.startsWith('(') && date.endsWith(')'))
                        .map(date => date.slice(1, -1)); // æ‹¬å¼§ã‚’é™¤å»
                    
                    if (!acc[category]) {
                        acc[category] = {
                            title: category,
                            type: "list",
                            spots: []
                        };
                    }

                    // æ—¢ã«åŒã˜IDã®ã‚¹ãƒãƒƒãƒˆãŒå­˜åœ¨ã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
                    const spotId = `${category}-${noInCategory}`;
                    const existingSpot = acc[category].spots.find(spot => spot.id === spotId);
                    if (!existingSpot) {
                        acc[category].spots.push({
                            id: spotId,
                            name: name,
                            coordinates: [latitude, longitude],
                            confirmedDates: confirmedDates,
                            partialDates: partialDates
                        });
                    }

                    return acc;
                }, {});

                updateAchievements();
            } catch (error) {
                console.error('ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ:', error);
                document.getElementById('achievements-container').innerHTML = 
                    '<p class="error">ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚</p>';
            }
        }

        // å®Ÿç¸¾é …ç›®ã‚’ç”Ÿæˆã™ã‚‹é–¢æ•°
        function createAchievementItem(id, spot) {
            const hasConfirmedVisits = spot.confirmedDates && spot.confirmedDates.length > 0;
            const hasPartialVisits = spot.partialDates && spot.partialDates.length > 0;
            
            const mapLink = spot.coordinates
                ? `<div class="map-link">
                    <a href="https://www.google.com/maps?q=${spot.coordinates[0]},${spot.coordinates[1]}" target="_blank" rel="noopener noreferrer">
                        <small>ğŸ“åœ°å›³ã‚’é–‹ã</small>
                    </a>
                   </div>`
                : '';

            let visitStatus = 'unvisited';
            if (hasConfirmedVisits) visitStatus = 'achieved';
            else if (hasPartialVisits) visitStatus = 'partial';

            const confirmedDatesHtml = hasConfirmedVisits
                ? spot.confirmedDates.map(date => `<div class="visit-date">${date}</div>`).join('')
                : '';
            
            const partialDatesHtml = hasPartialVisits
                ? spot.partialDates.map(date => `<div class="visit-date partial">(${date})</div>`).join('')
                : '';

            const datesHtml = hasConfirmedVisits || hasPartialVisits
                ? confirmedDatesHtml + partialDatesHtml
                : '<div class="visit-date unvisited">æœªè¨ªå•</div>';

            return `
                <div class="achievement-item ${visitStatus}">
                    <h3>${spot.name}</h3>
                    <div class="achievement-dates" id="${id}-dates">
                        ${datesHtml}
                    </div>
                    ${mapLink}
                </div>
            `;
        }

        // å®Ÿç¸¾ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç”Ÿæˆã™ã‚‹é–¢æ•°
        function createAchievementSection(key, data) {
            const spots = data.spots;
            const items = spots.map(spot => createAchievementItem(spot.id, spot));
            
            const totalCount = spots.length;
            const confirmedCount = spots.filter(spot => spot.confirmedDates && spot.confirmedDates.length > 0).length;
            const partialCount = spots.filter(spot => spot.partialDates && spot.partialDates.length > 0).length;
            const progressText = partialCount > 0 
                ? `${confirmedCount}(+${partialCount})/${totalCount}`
                : `${confirmedCount}/${totalCount}`;

            return `
                <div class="achievement-section">
                    <h2 class="clickable" onclick="showMapForCategory('${key}')">${data.title}</h2>
                    <div class="achievement-list" id="${key}-list">
                        ${items.join('')}
                    </div>
                    <div class="achievement-progress">
                        é€²æ—çŠ¶æ³: <span id="${key}-progress">${progressText}</span>
                    </div>
                </div>
            `;
        }

        // å®Ÿç¸¾ã®æ›´æ–°é–¢æ•°
        function updateAchievements() {
            const container = document.getElementById('achievements-container');
            container.innerHTML = Object.entries(achievementsData)
                .map(([key, data]) => createAchievementSection(key, data))
                .join('');
        }

        // åœ°å›³ã‚’è¡¨ç¤ºã™ã‚‹é–¢æ•°
        function showMapForCategory(key) {
            const data = achievementsData[key];
            const modal = document.getElementById('mapModal');
            const mapTitle = document.getElementById('mapTitle');
            
            mapTitle.textContent = data.title;
            modal.style.display = 'block';

            if (map) {
                map.remove();
            }

            map = L.map('map');
            L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
                attribution: 'Â© OpenStreetMap & CartoDB',
                subdomains: 'abcd'
            }).addTo(map);

            // ä½ç½®æƒ…å ±ãƒœã‚¿ãƒ³ã‚’è¿½åŠ 
            const locationButton = L.control({ position: 'bottomright' });
            locationButton.onAdd = () => {
                const div = L.DomUtil.create('div', 'leaflet-bar leaflet-control');
                div.innerHTML = `
                    <a href="#" title="ç¾åœ¨åœ°ã‚’è¡¨ç¤º" style="display: flex; align-items: center; justify-content: center; width: 30px; height: 30px; background: white; border-radius: 4px;">
                        <svg viewBox="0 0 24 24" style="width: 18px; height: 18px;">
                            <path d="M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3A8.994 8.994 0 0 0 13 3.06V1h-2v2.06A8.994 8.994 0 0 0 3.06 11H1v2h2.06A8.994 8.994 0 0 0 11 20.94V23h2v-2.06A8.994 8.994 0 0 0 20.94 13H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z" fill="currentColor"/>
                        </svg>
                    </a>
                `;
                div.onclick = (e) => {
                    e.preventDefault();
                    showCurrentLocation(map);
                };
                return div;
            };
            locationButton.addTo(map);

            // è¨ªå•æ¸ˆã¿ã€éƒ¨åˆ†è¨ªå•ã€æœªè¨ªå•ã®ãƒãƒ¼ã‚«ãƒ¼ã‚¢ã‚¤ã‚³ãƒ³ã‚’å®šç¾©
            const visitedIcon = L.divIcon({
                className: 'custom-marker',
                html: `<div class="marker-circle" style="background-color: green;">âœ“</div>`,
                iconSize: [12, 12],
                iconAnchor: [6, 6]
            });

            const partialIcon = L.divIcon({
                className: 'custom-marker',
                html: `<div class="marker-circle" style="background-color: #ffa000;">â–³</div>`,
                iconSize: [12, 12],
                iconAnchor: [6, 6]
            });

            const unvisitedIcon = L.divIcon({
                className: 'custom-marker',
                html: `<div class="marker-circle" style="background-color: red;">Ã—</div>`,
                iconSize: [12, 12],
                iconAnchor: [6, 6]
            });

            const coordinates = [];
            
            data.spots.forEach(spot => {
                if (spot.coordinates) {
                    coordinates.push(spot.coordinates);
                    const hasConfirmedVisits = spot.confirmedDates && spot.confirmedDates.length > 0;
                    const hasPartialVisits = spot.partialDates && spot.partialDates.length > 0;
                    
                    let visitInfo;
                    let icon;
                    if (hasConfirmedVisits) {
                        visitInfo = `è¨ªå•æ¸ˆã¿<br>${spot.confirmedDates.map(date => `ãƒ»${date}`).join('<br>')}`;
                        if (hasPartialVisits) {
                            visitInfo += `<br>å‚è€ƒè¨˜éŒ²<br>${spot.partialDates.map(date => `ãƒ»${date}`).join('<br>')}`;
                        }
                        icon = visitedIcon;
                    } else if (hasPartialVisits) {
                        visitInfo = `å‚è€ƒè¨˜éŒ²<br>${spot.partialDates.map(date => `ãƒ»${date}`).join('<br>')}`;
                        icon = partialIcon;
                    } else {
                        visitInfo = 'æœªè¨ªå•';
                        icon = unvisitedIcon;
                    }

                    L.marker(spot.coordinates, { icon })
                    .bindPopup(`
                        <strong>${spot.name}</strong><br>
                        ${visitInfo}
                    `)
                    .addTo(map);
                }
            });

            if (coordinates.length > 0) {
                const bounds = L.latLngBounds(coordinates);
                map.fitBounds(bounds, { padding: [50, 50] });
            }
        }

        // åœ°å›³ã‚’é–‰ã˜ã‚‹é–¢æ•°
        function closeMap() {
            const modal = document.getElementById('mapModal');
            modal.style.display = 'none';
            if (map) {
                map.remove();
                map = null;
            }
        }

        // ãƒ¢ãƒ¼ãƒ€ãƒ«ã®å¤–å´ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸã¨ãã«é–‰ã˜ã‚‹
        window.onclick = function(event) {
            const modal = document.getElementById('mapModal');
            if (event.target == modal) {
                closeMap();
            }
        }

        // ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚“ã§åˆæœŸè¡¨ç¤º
        loadAchievementsData();

        function showLocationOnMap(lat, lng, name) {
            const modal = document.getElementById('mapModal');
            const mapTitle = document.getElementById('mapTitle');
            
            mapTitle.textContent = name;
            modal.style.display = 'block';

            if (map) {
                map.remove();
            }

            map = L.map('map').setView([lat, lng], 15);
            L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
                attribution: 'Â© OpenStreetMap & CartoDB',
                subdomains: 'abcd'
            }).addTo(map);

            // ä½ç½®æƒ…å ±ãƒœã‚¿ãƒ³ã‚’è¿½åŠ 
            const locationButton = L.control({ position: 'bottomright' });
            locationButton.onAdd = () => {
                const div = L.DomUtil.create('div', 'leaflet-bar leaflet-control');
                div.innerHTML = `
                    <a href="#" title="ç¾åœ¨åœ°ã‚’è¡¨ç¤º" style="display: flex; align-items: center; justify-content: center; width: 30px; height: 30px; background: white; border-radius: 4px;">
                        <svg viewBox="0 0 24 24" style="width: 18px; height: 18px;">
                            <path d="M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3A8.994 8.994 0 0 0 13 3.06V1h-2v2.06A8.994 8.994 0 0 0 3.06 11H1v2h2.06A8.994 8.994 0 0 0 11 20.94V23h2v-2.06A8.994 8.994 0 0 0 20.94 13H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z" fill="currentColor"/>
                        </svg>
                    </a>
                `;
                div.onclick = (e) => {
                    e.preventDefault();
                    showCurrentLocation(map);
                };
                return div;
            };
            locationButton.addTo(map);

            // å ´æ‰€ã®ãƒãƒ¼ã‚«ãƒ¼ã‚’è¿½åŠ 
            L.marker([lat, lng]).addTo(map).bindPopup(name).openPopup();
        }

        // ç¾åœ¨åœ°ã‚’å–å¾—ã—ã¦è¡¨ç¤ºã™ã‚‹é–¢æ•°
        function showCurrentLocation(map) {
            if (!navigator.geolocation) {
                alert('ãŠä½¿ã„ã®ãƒ–ãƒ©ã‚¦ã‚¶ã§ã¯ä½ç½®æƒ…å ±ã®å–å¾—ãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚');
                return;
            }

            let locationMarker = null;
            let locationCircle = null;

            navigator.geolocation.getCurrentPosition(
                (position) => {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;
                    const accuracy = position.coords.accuracy;

                    // æ—¢å­˜ã®ãƒãƒ¼ã‚«ãƒ¼ã¨ã‚µãƒ¼ã‚¯ãƒ«ã‚’å‰Šé™¤
                    if (locationMarker) map.removeLayer(locationMarker);
                    if (locationCircle) map.removeLayer(locationCircle);

                    // ç¾åœ¨åœ°ãƒãƒ¼ã‚«ãƒ¼ã‚’ä½œæˆ
                    locationMarker = L.marker([lat, lng], {
                        icon: L.divIcon({
                            className: 'location-marker',
                            html: '<div style="background-color: #2196F3; width: 12px; height: 12px; border-radius: 50%; border: 2px solid white; box-shadow: 0 0 4px rgba(0,0,0,0.5);"></div>',
                            iconSize: [16, 16],
                            iconAnchor: [8, 8]
                        })
                    }).addTo(map);

                    // ç²¾åº¦ã‚’ç¤ºã™å††ã‚’ä½œæˆ
                    locationCircle = L.circle([lat, lng], {
                        radius: accuracy,
                        color: '#2196F3',
                        fillColor: '#2196F3',
                        fillOpacity: 0.15,
                        weight: 1
                    }).addTo(map);

                    // ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã§æƒ…å ±ã‚’è¡¨ç¤º
                    locationMarker.bindPopup(`
                        <b>ç¾åœ¨åœ°</b><br>
                        ç·¯åº¦: ${lat.toFixed(6)}<br>
                        çµŒåº¦: ${lng.toFixed(6)}<br>
                        ç²¾åº¦: ${accuracy.toFixed(1)}m
                    `).openPopup();

                    // ç¾åœ¨åœ°ã«ã‚ºãƒ¼ãƒ 
                    map.setView([lat, lng], 15);
                },
                (error) => {
                    let errorMessage = 'ä½ç½®æƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚';
                    switch(error.code) {
                        case error.PERMISSION_DENIED:
                            errorMessage = 'ä½ç½®æƒ…å ±ã®ä½¿ç”¨ãŒè¨±å¯ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚';
                            break;
                        case error.POSITION_UNAVAILABLE:
                            errorMessage = 'ä½ç½®æƒ…å ±ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚';
                            break;
                        case error.TIMEOUT:
                            errorMessage = 'ä½ç½®æƒ…å ±ã®å–å¾—ãŒã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸã€‚';
                            break;
                    }
                    alert(errorMessage);
                },
                {
                    enableHighAccuracy: true,  // é«˜ç²¾åº¦ã®ä½ç½®æƒ…å ±ã‚’è¦æ±‚
                    timeout: 10000,            // 10ç§’ã§ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ
                    maximumAge: 0              // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã—ãŸä½ç½®æƒ…å ±ã‚’ä½¿ç”¨ã—ãªã„
                }
            );
        }
    </script>
</body>
</html>
